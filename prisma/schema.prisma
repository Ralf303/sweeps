generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id              String  @id @default(uuid())
    nickname        String  @unique
    email           String  @unique
    password        String
    role            String  @default("user")
    balance         Float   @default(0)
    referralsCount  Int     @default(0)
    referredById    String?
    referralLevel   Int     @default(1)
    dailyLose       Int     @default(0)
    referralAllLose Int     @default(1)
    isBanned        Boolean @default(false)
    referralCode    String  @unique @default("")

    referredBy  User?         @relation("UserReferrals", fields: [referredById], references: [id])
    referrals   User[]        @relation("UserReferrals")
    Transaction Transaction[]

    createdAt   DateTime      @default(now())
    updatedAt   DateTime      @updatedAt
    ChatMessage ChatMessage[]
}

model Transaction {
    id                 String   @id @default(uuid())
    player_id          String   @default("")
    transaction_id     String   @unique
    action             String   @default("")
    amount             Float    @default(0)
    currency           String   @default("")
    round_id           String?
    game_uuid          String?
    bet_transaction_id String?
    rolled_back        Boolean  @default(false)
    created_at         DateTime @default(now())
    User               User?    @relation(fields: [userId], references: [id])
    userId             String?

    @@index([player_id])
}

model Banner {
    id          String @id @default(uuid())
    title       String
    description String
    buttonText  String
    buttonLink  String
    imageUrl    String

    createdAt DateTime @default(now())
}

model News {
    id          String @id @default(uuid())
    title       String
    description String
    imageUrl    String

    createdAt DateTime @default(now())
}

model faq {
    id          String @id @default(uuid())
    title       String
    description String

    createdAt DateTime @default(now())
}

model ChatMessage {
    id        String   @id @default(uuid())
    userId    String
    text      String
    createdAt DateTime @default(now())

    user User @relation(fields: [userId], references: [id])
}
